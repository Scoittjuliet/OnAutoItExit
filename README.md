# OnAutoItExit
; I am the server, start me first! (Start in second the below example script).   #include &lt;Constants.au3>   Example()   Func Example()     TCPStartup() ; Start the TCP service.       ; Register OnAutoItExit to be called when the script is closed.     OnAutoItExitRegister("OnAutoItExit")       ; Assign Local variables the loopback IP Address and the Port.     Local $sIPAddress = "127.0.0.1" ; This IP Address only works for testing on your own computer.     Local $iPort = 65432 ; Port used for the connection.       ; Assign a Local variable the socket and bind to the IP Address and Port specified with a maximum of 100 pending connexions.     Local $iListenSocket = TCPListen($sIPAddress, $iPort, 100)       ; If an error occurred display the error code and return False.     If @error Then         ; Someone is probably already listening on this IP Address and Port (script already running?).         MsgBox(BitOR($MB_SYSTEMMODAL, $MB_ICONHAND), "", "Server: Could not listen, Error code: " &amp; @error)         Return False     EndIf       ; Assign a Local variable to be used by the Client socket.     Local $iSocket = 0       Do ; Wait for someone to connect (Unlimited).         ; Accept incomming connexions if present (Socket to close when finished; one socket per client).         $iSocket = TCPAccept($iListenSocket)           ; If an error occurred display the error code and return False.         If @error Then             MsgBox(BitOR($MB_SYSTEMMODAL, $MB_ICONHAND), "", "Server: Could not accept the incoming connection, Error code: " &amp; @error)             Return False         EndIf     Until $iSocket &lt;> -1 ;if different from -1 a client is connected.       ; Close the Listening socket to allow afterward binds.     TCPCloseSocket($iListenSocket)       ; Assign a Local variable the data received.     Local $sReceived = TCPRecv($iSocket, 4) ;we're waiting for the string "tata" OR "toto" (example script TCPRecv): 4 bytes length.       ; Notes: If you don't know how much length will be the data,     ; use e.g: 2048 for maxlen parameter and call the function until the it returns nothing/error.       ; Display the string received.     MsgBox($MB_SYSTEMMODAL, "", "Server: Received: " &amp; $sReceived)       ; Close the socket.     TCPCloseSocket($iSocket) EndFunc   ;==>Example   Func OnAutoItExit()     TCPShutdown() ; Close the TCP service. EndFunc   ;==>OnAutoItExit
